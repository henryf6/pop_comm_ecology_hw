---
title: "EEB 5301 Homework 4"
author: "Samantha Apgar & Henry Frye"
date: "Spring 2017"
output: 
  tufte::tufte_handout:
    keep_tex: false
---

# Problem 1
 
 r = .001 individ/individ/day
 K = 1000 indivs/enclsoure
 a = .5 
 h = .02083 days
 lady bugs live 3 days in enclosures
 2 x food = 20% more aphids
 q = 1/3 ladybugs/day
 f = .01 

```{r}
r=.001
a=.5
k1=1000
k2=1200
h=.02083
q=1/3
f=.01

N1= 1:k1
N2= 1:k2
Prey1 = (r*N1 * (1 - (N1/k1))* (a*N1)) / (1+a*h*N1)
Prey2 = (r*N2 * (1 - (N2/k2))* (a*N2)) / (1+a*h*N2)
#Prey2 = (r / (a * k2)) * (k2 - (k2*a*h + 1)*N2 - a*h*(N2^2))

Predator = ( q / (f*a - a*h*q))

plot(x = N1, y  = Prey1, bty = 'n', ylim = c(0,15), type = 'l')
abline(v = Predator, col = 'red')
lines(Prey2, col = 'cadetblue')

```

# Problem 2

```{r vegan setup, echo = FALSE, warning = FALSE, message = FALSE}
library(vegan)
library(dplyr)
library(tidyr)
library(ggplot2)
library(ggthemes)
data(dune)
data(dune.env)

dune.sum	<- aggregate(dune,	list(Moisture	=	dune.env$Moisture),	sum)
dune.sum1	<- dune.sum[,-1]
rownames(dune.sum1)	<- dune.sum[,1]

radPlot	<- function(x,	add=FALSE,	col='black',	...){
		x	<- x[x>0]
		x	<- x[rev(order(x))]
		if(!add)
				plot(1:length(x),	x,	type='l',	xlab='Rank',	ylab='Abundance	(log	scale)',
									log='y',	col=col,	...)
		else
				lines(1:length(x),	x,	col=col,	...)
		return(NULL)}

```

##Part a

```{r}
specnumber(dune.sum1)
```

As moisture increases, species richness decreases from moisture level 1 to level 4, but then suddenly increases at level 5. The most rich is level 5 while level 4 is the least rich.

## Part b

```{r}
sort(diversity(dune.sum1))
```

According to Shannon's Index, the moisture level is ranked 5 > 2 > 1 > 4 in order of high diversity to lowest.

## Part c

```{r}
sort(exp(diversity(dune.sum1)))
sort(1/(diversity(dune.sum1, index = 'invsimpson')))
```

The effective number of species between Simpson's and Shannon's index are almost flipped.  Moisture level 4 has the lowest effective number of species according to Shannon's index while the level 4 is considered the having the highest effective number of species according to Simpson's.

## Part d


```{r}
dumdum <-data.frame(level1= as.numeric(dune.sum1[1,]))
ggplot(dumdum, aes(level1)) + geom_histogram() + theme_tufte()
```

There are approximately 6 individuals that appear twice at moisture level 1.  Out 250 individuals the probability is 2.4%.

## Part e


```{r}
radPlot(x = dune.sum1[1,], bty = 'n')
radPlot(x = dune.sum1[2,], add = TRUE, col = 'blue')
radPlot(x = dune.sum1[3,], add = TRUE, col = 'red')
radPlot(x = dune.sum1[4,], add = TRUE, col = 'limegreen')
legend('topright', legend = c('1','2',"4","5"),
       col = c("black","blue","red","limegreen"), lty =1,lwd=2)
```


## Part f

Based on the plot above, moisture level 1, appears to be the most even since it has the flattest slope. However, this is is not much flatter than level 5 and not easily interpreted.

One way to better quantify evenness would be to calculate the Hill's ratio from either of the diversity indices above.

## Part g

Simpson's index tends to be less sensitive to rare species than Shannon's index. It is weighted towards the most abundant species.  In part c, Simpson's index tended to favor level 4 as the most diverse, which makes sense from the graph in part e that shows level 4 as the most dominated by common abundant species (i.e. lack of sensitivity towards rare species).

## Part h
```{r}

```

## Part i
```{r}

```


