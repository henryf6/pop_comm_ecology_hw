---
title: "Population & Community Ecology Homework 1"
author: Samantha Apgar & Henry Frye
output: 
  pdf_document: default
---

#Problem 1

In this problem we look to find the density of duckweed plants per $m^2$ after 47 days. We will estimate the future population using the exponential growth formula, $N_t = N_0 e^{rt}$ where the initial population, $N_0$, is 11.1 duckweed plants per $m^2$.  We can calculate the rate of unitless population change, r, by using the above equation.

```{r}
r <- (log(23.5/11.1))/20
r
```

Thus with r= 0.03750, we can calculate $N_{47}$ by using the equation $N_t = N_0 e^{rt}$ again.

```{r}
N47 <- 11.1*(exp(0.0375*47))
N47
```

Thus after a total of 47 days, the population density will be 64.680 duckweed plants per $m^2$.

***

#Problem 2

In this problem we want to find the time at which both Ethipia and Mexico will have the same population size, while starting at different population sizes and growing at different rates. We will determine this time by setting the exponential growth formula, $N_t = N_0 e^{rt}$ for each population equal to eachother and solving for t (time). The initial population, $N_0$, for Mexico is 121,005,000 and r is 1.2% and the initial population for Ethiopia, $N_0$, is 90,076,000 and r is 2.9%. 

```{r}
#121005000exp
# Sam, I assume you'll finish the R calcs later.  FYI, when there's an issue # in a code chunk, trying to knit will return some form of error.
```

In 0.1736 years the populations of Mexico and Ethiopia will be equal. 

***

#Problem 3

##Part a 
Given the information we would like to solve for $N_7$, the population in seven years.

```{r}
n_7 <- (1.037^7)*112
n_7
```

Thus the population density will be 144 (rounded, no units given) at year 7.

##Part b
Using the exponential growth formula, $N_t = N_0 e^{rt}$, we would like to
solve for an r value where $N_0 = 112$ and $N_t = 144$. Thus we solve for r as $ln(\frac{N_t}{N_0})/t=r$.  

```{r}
r <- log(144/112)/7
r
```

Thus r is equal to .036 in the exponential model to  achieve the same results as the discrete population growth model.

***

#Problem 4

***



#Problem 5

$l_x$ and $p_x$ are solved below and placed into the following life history table:
```{r}
library(knitr)
age <- 0:4
sx <- c(740,280,105,32,0)
bx <- c(0,0.4,1.3,3.8,NA)
lx <- sx/740

px <- vector(mode = 'numeric',length = 5)
for(i in 1:length(lx)){
  px[i] <- (lx[i+1]/lx[i])
}

lifetable <- cbind(age,sx,lx,px,bx)
colnames(lifetable) <- c('Age','S_x','l_x','p_x','b_x')
lifetable <- as.data.frame(lifetable)
kable(lifetable)


```

We solve for $R_0$ in the following:
```{r}
r0 <- sum(lifetable$l_x*lifetable$b_x, na.rm= TRUE)
r0
```

Thus $R_0= .5$

We solve for G as
```{r}
(with(lifetable, sum(age*l_x*b_x, na.rm = TRUE))/r0)

```

Thus we find the generation time, G, to be about 2.03.


***

#Problem 6


***

#Problem 7

The following is the setup for the population project matrix:
```{r}

stages <- c('seedling','juvenile','small adult', 'medium adult', 'large adult')
A <-  matrix(c(
     0,  0,.015,.063,.189,
  .294,.25, 0  , 0  , 0  ,
  .176,.35,.385,.059,.012,
     0,.35,.461,.568,.171,
     0, 0 ,.108,.356,.805
), nrow = 5, byrow = TRUE,
   dimnames = list(stages,stages)
)
```

##Population Projection matrix
```{r}
library(knitr)
kable(A)
```


##Part a
To calculate $\lambda$ from the popbio package we do the following:
```{r}
library(popbio)
lambda(A)
```
Thus $\lambda = 1.04$.

##Part b
To calculate the stable stage distribution we do the following:
```{r}
stable.stage(A)
```
##Part c
Calculating sensitivity table as such:
```{r}
sense <- sensitivity(A)
kable(sense)
```

Calculating elasticity table
```{r}
elast <- elasticity(A)
kable(elast)
```


The largest elasticity value is the probability of staying a large adult tree, with a value of .42.


##Part d
Cutting the value of adult tree fecundities by half:
```{r}
B <- A
.189/2 -> B[1,5]
.063/2 -> B[1,4]
.015/2 -> B[1,3]
lambda(B)
```

Thus the value of $\lambda$ is now 1.013 and the stable-age distribution is:

```{r}
stable.stage(B)
```


When the fecunditities for adult trees were cut by half lambda decreased by .024.  The stable-age distribution was higher for medium and adult trees when fecundities of all adult trees was reduced suggesting a forest with stable ages skewed towards older trees.

##Part e
Cutting the probabilities that trees stay in the same class by half:
```{r}
C <- A
.385/2 -> C[3,3]
.568/2 -> C[4,4]
.805/2 -> C[5,5]
lambda(C)
```

Thus the value of lambda is reduced quite a bit more than the previous case with a value of .746. The stable-age distribution is:
```{r}
stable.stage(C)
```

Now the stable age distribution has now increased in all classes but large adult trees. This suggests that large adult trees have a large role in dictating the age distribution within the population.

#Problem 8

```{r, echo = FALSE}

StochasticSim <- function(steps,b,d,N0){
  N <- numeric(steps + 1);
  t <- numeric(steps + 1);
  N[1] <- N0;
  t[1] <- 0;
  for(i in 1:steps){
    if (N[i]>0) {
      eventTime <- rexp(1,(b+d)*N[i])
      t[i+1] <- t[i] + eventTime 
    if (runif(1) < (b/(b+d))) {
      N[i+1] <- N[i] + 1
  } else {
    N[i+1] <- N[i] - 1
    }
  }
  else {
      N[i+1] <- 0
      t[i+1] <- t[i]
    }
}
#plot(N~t,type='l')
return(N[steps+1])
}
```

Running the stochastic simulation 50 times with 50 steps, $N_0=10$, b=.55 and d=.5 yields the following vector.
```{r}
sim10runs <- vector(mode = 'numeric',length = 50)

for(i in 1:50){
    sim10runs[i] <- StochasticSim(steps = 50,b=.55,d=.5, N0=10)
} 


propextinction10 <- length(which(sim10runs == 0))/length(sim10runs)
paste('Extinction rate is:',propextinction10)
sim10runs
```

Running the same stochastic simulation, but with $N_0=50$ yields

```{r}
sim50runs <- vector(mode = 'numeric',length = 50)

for(i in 1:50){
    sim50runs[i] <- StochasticSim(steps = 50,b=.55,d=.5, N0=50)
} 


propextinction50 <- length(which(sim50runs == 0))/length(sim50runs)
paste('Extinction rate is:',propextinction50)
sim50runs
```



#Problem 9